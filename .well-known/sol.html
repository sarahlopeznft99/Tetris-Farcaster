<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tetris Mini App</title>
  <style>
    :root {
      --bg: #0b0e1a;
      --fg: #e6e6e6;
      --yellow: #facc15;
      --yellow-hover: #eab308;
    }
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--fg);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .card {
      background: #11152a;
      padding: 24px;
      border-radius: 14px;
      box-shadow: 0 8px 24px rgba(0,0,0,.35);
      max-width: 320px;
      text-align: center;
    }
    h1.title {
      margin-top: 0;
      font-size: 20px;
      font-weight: 700;
    }
    p.muted {
      color: #9ca3af;
      font-size: 14px;
      margin: 8px 0 16px;
    }
    .row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
    }
    button {
      border: none;
      border-radius: 10px;
      padding: 8px 14px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s, transform 0.2s;
    }
    button.yellow-btn {
      background: var(--yellow);
      color: #1a1a1a;
    }
    button.yellow-btn:hover {
      background: var(--yellow-hover);
      transform: translateY(-1px);
    }
    canvas {
      display: none;
      background: #0b0e1a;
      border-radius: 14px;
      box-shadow: 0 8px 24px rgba(0,0,0,.4);
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="card" id="intro">
    <h1 class="title">Play Tetris</h1>
    <p class="muted">Click below to start playing Tetris!</p>
    <div class="row">
      <button id="play" type="button" class="yellow-btn">Play</button>
    </div>
  </div>

  <canvas id="board" width="240" height="480"></canvas>

  <script>
  (() => {
    const COLS = 10, ROWS = 20, TILE = 24;
    const canvas = document.getElementById("board");
    const ctx = canvas.getContext("2d");
    const intro = document.getElementById("intro");
    const playBtn = document.getElementById("play");
    canvas.width = COLS * TILE;
    canvas.height = ROWS * TILE;

    const SHAPES = {
      I:[[1,1,1,1]],
      O:[[1,1],[1,1]],
      T:[[0,1,0],[1,1,1]],
      S:[[0,1,1],[1,1,0]],
      Z:[[1,1,0],[0,1,1]],
      J:[[1,0,0],[1,1,1]],
      L:[[0,0,1],[1,1,1]]
    };
    const COLORS = {
      I:"#00f0f0", O:"#f0f000", T:"#a000f0", S:"#00f000",
      Z:"#f00000", J:"#0000f0", L:"#f0a000"
    };
    let grid = Array.from({length:ROWS},()=>Array(COLS).fill(0));
    let current = null;
    let dropTimer = 0, dropInterval = 500;
    let lastTime = 0;
    let paused = false;

    function newPiece() {
      const keys = Object.keys(SHAPES);
      const type = keys[Math.floor(Math.random()*keys.length)];
      const shape = SHAPES[type];
      return { type, shape: shape.map(r=>r.slice()), x: Math.floor((COLS-shape[0].length)/2), y: -1 };
    }

    function drawGrid(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for(let y=0;y<ROWS;y++)
        for(let x=0;x<COLS;x++)
          if(grid[y][x]){
            ctx.fillStyle = COLORS[grid[y][x]];
            ctx.fillRect(x*TILE,y*TILE,TILE,TILE);
          }
      if(current){
        ctx.fillStyle = COLORS[current.type];
        for(let y=0;y<current.shape.length;y++)
          for(let x=0;x<current.shape[0].length;x++)
            if(current.shape[y][x])
              ctx.fillRect((current.x+x)*TILE,(current.y+y)*TILE,TILE,TILE);
      }
    }

    function collide(nx,ny,shape){
      for(let y=0;y<shape.length;y++)
        for(let x=0;x<shape[0].length;x++)
          if(shape[y][x]){
            const gx=nx+x, gy=ny+y;
            if(gx<0||gx>=COLS||gy>=ROWS) return true;
            if(gy>=0 && grid[gy][gx]) return true;
          }
      return false;
    }

    function place(){
      for(let y=0;y<current.shape.length;y++)
        for(let x=0;x<current.shape[0].length;x++)
          if(current.shape[y][x] && current.y+y>=0)
            grid[current.y+y][current.x+x]=current.type;
    }

    function clearLines(){
      for(let y=ROWS-1;y>=0;y--){
        if(grid[y].every(cell=>cell!==0)){
          grid.splice(y,1);
          grid.unshift(Array(COLS).fill(0));
          y++;
        }
      }
    }

    function rotate(shape){
      return shape[0].map((_,i)=>shape.map(row=>row[i]).reverse());
    }

    function step(){
      if(!current) current=newPiece();
      else {
        const ny=current.y+1;
        if(!collide(current.x,ny,current.shape)){
          current.y=ny;
        } else {
          place();
          clearLines();
          current=newPiece();
          if(collide(current.x,current.y,current.shape)){
            alert("Game Over!");
            grid=Array.from({length:ROWS},()=>Array(COLS).fill(0));
          }
        }
      }
      drawGrid();
    }

    function update(time=0){
      const delta=time-lastTime; lastTime=time;
      dropTimer+=delta;
      if(dropTimer>dropInterval){ step(); dropTimer=0; }
      requestAnimationFrame(update);
    }

    document.addEventListener("keydown", e=>{
      if(!current) return;
      if(e.key==="ArrowLeft"&&!collide(current.x-1,current.y,current.shape)) current.x--;
      else if(e.key==="ArrowRight"&&!collide(current.x+1,current.y,current.shape)) current.x++;
      else if(e.key==="ArrowUp"){
        const r=rotate(current.shape);
        if(!collide(current.x,current.y,r)) current.shape=r;
      }
      else if(e.key==="ArrowDown"&&!collide(current.x,current.y+1,current.shape)) current.y++;
      drawGrid();
    });

    playBtn.addEventListener("click", ()=>{
      intro.style.display="none";
      canvas.style.display="block";
      grid=Array.from({length:ROWS},()=>Array(COLS).fill(0));
      current=newPiece();
      requestAnimationFrame(update);
    });
  })();
  </script>
</body>
</html>
